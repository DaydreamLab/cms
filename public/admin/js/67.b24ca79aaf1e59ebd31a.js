webpackJsonp([67],{"Bj2+":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("o/zv"),i=n.n(a);t.default={name:"Media",data:function(){return{params:{dir:"/",path:this.filePath,total:""},view:"list",folders:[],files:[],loading:!1,selected:[],newFolderName:"",showCreateFolderBtn:!1,showUploadFileBtn:!1,folderTreeProps:{label:"name",children:"children"}}},props:{filePath:{type:String,default:""}},watch:{selected:function(e){this.$emit("change",e)},"params.dir":function(e){this.$refs.folderTree.setCurrentKey(e)},filePath:function(e){this.params.path=e}},created:function(){this.initMedia()},methods:{handleDeleteFile:function(){var e=this;this.$$api_media_delete({data:{paths:this.selected},fn:function(){e.resetSelectedFiles()}})},updateSelectedFiles:function(e){this.selected=e.map(function(e){return e.path})},resetSelectedFiles:function(){this.selected=[],this.handleGetFiles()},onDoubleClickItem:function(e){"Folder"===e.type?this.updateParamDir(e):this.updateParamPath(e)},updateParamPath:function(e){this.params.path=e.path},updateParamDir:function(e){this.params.dir=e.path,this.resetSelectedFiles()},handleUploadFile:function(){this.$refs.fileUpload.submit()},handleUploadFiles:function(e){var t=this,n=new FormData;n.append("files[]",e.file),n.append("dir",this.params.dir),this.$$api_media_uploadFile({headers:{"Content-Type":"multipart/form-data"},data:n,fn:function(n){var a=n.msg;t.$message.success(a),e.onSuccess(),t.$refs.fileUpload.clearFiles(),t.showUploadFileBtn=!1,t.handleGetFiles()},errFn:function(n){t.$message.error(n),e.onError()}})},handleCreateFolder:function(){var e=this;this.$$api_media_createFolder({data:{dir:this.params.dir,name:this.newFolderName},fn:function(t){t.data;e.newFolderName="",e.showCreateFolderBtn=!1,e.handleGetFiles(),e.handleGetFolders()}})},handleGetFolders:function(){var e=this;this.$$api_media_listFolder({fn:function(t){var n=t.data;n.items[0].name=e.$t("GLOBAL_ROOT"),e.folders=n.items}})},handleGetFiles:function(){var e=this;this.loading=!0,this.$$api_media_listFile({data:{dir:this.params.dir},fn:function(t){var n=t.data;e.files=n.items,e.params.total=n.records,e.loading=!1}})},formatItemDate:function(e){return this.$options.filters.displayDateFormat(e.modified)},initMedia:function(){this.handleGetFolders(),this.params.path&&(this.params.dir=i.a.dirname(this.params.path)||this.params.dir,this.selected.push(this.params.path)),this.handleGetFiles()}}}},EOXh:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticClass:"media-container"},[n("el-header",{staticClass:"media-toolbar"},[n("el-radio-group",{staticClass:"media-toolbar__item",model:{value:e.view,callback:function(t){e.view=t},expression:"view"}},[n("el-radio-button",{attrs:{label:"icon"}},[n("font-awesome-icon",{attrs:{icon:["fal","grip-horizontal"]}}),e._v("\n        "+e._s(e.$t("MEDIA_THUMB_VIEW"))+"\n      ")],1),e._v(" "),n("el-radio-button",{attrs:{label:"list"}},[n("font-awesome-icon",{attrs:{icon:["fal","bars"]}}),e._v("\n        "+e._s(e.$t("MEDIA_LIST_VIEW"))+"\n      ")],1)],1),e._v(" "),n("el-button-group",{staticClass:"media-toolbar__item"},[n("el-button",{attrs:{type:e.showUploadFileBtn?"info":"success"},on:{click:function(t){e.showUploadFileBtn=!e.showUploadFileBtn}}},[e.showUploadFileBtn?[n("font-awesome-icon",{attrs:{icon:["fal","times"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_CANCEL")+e.$t("MEDIA_UPLOAD"))+"\n        ")]:[n("font-awesome-icon",{attrs:{icon:["fal","upload"]}}),e._v("\n          "+e._s(e.$t("MEDIA_UPLOAD"))+"\n        ")]],2),e._v(" "),n("el-button",{attrs:{type:e.showCreateFolderBtn?"info":""},on:{click:function(t){e.showCreateFolderBtn=!e.showCreateFolderBtn}}},[e.showCreateFolderBtn?[n("font-awesome-icon",{attrs:{icon:["fal","times"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_CANCEL")+e.$t("MEDIA_CREATE_DIR"))+"\n        ")]:[n("font-awesome-icon",{attrs:{icon:["fal","plus"]}}),e._v("\n          "+e._s(e.$t("MEDIA_CREATE_DIR"))+"\n        ")]],2)],1),e._v(" "),n("el-button-group",{staticClass:"media-toolbar__item"},[n("el-button",{attrs:{disabled:e.selected.length<=0},on:{click:e.handleDeleteFile}},[n("font-awesome-icon",{attrs:{icon:["fal","trash-alt"]}}),e._v("\n        "+e._s(e.$t("TOOLBAR_DELETE"))+"\n      ")],1)],1)],1),e._v(" "),n("el-container",[n("el-aside",{staticClass:"media-aside",attrs:{width:"200px"}},[n("el-tree",{ref:"folderTree",attrs:{"node-key":"path",data:e.folders,props:e.folderTreeProps,"expand-on-click-node":!1,"default-expand-all":"","highlight-current":""},on:{"node-click":e.updateParamDir}})],1),e._v(" "),n("el-main",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"media-main"},[n("div",{staticClass:"media-create"},[e.showCreateFolderBtn?n("el-input",{staticClass:"media-create__item",model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}},[n("template",{slot:"prepend"},[e._v(e._s(e.params.dir))]),e._v(" "),n("el-button",{attrs:{slot:"append"},on:{click:e.handleCreateFolder},slot:"append"},[e._v(e._s(e.$t("MEDIA_CREATE")))])],2):e._e(),e._v(" "),e.showUploadFileBtn?n("el-upload",{ref:"fileUpload",staticClass:"media-create__item",attrs:{multiple:"",action:"string","http-request":e.handleUploadFiles,"auto-upload":!1}},[n("el-button",{attrs:{slot:"trigger"},slot:"trigger"},[e._v(e._s(e.$t("MEDIA_SELECT_FILE")))]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.handleUploadFile}},[e._v(e._s(e.$t("MEDIA_UPLOAD")))]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t("MEDIA_UPLOAD_FILE_LIMIT")))])],1):e._e()],1),e._v(" "),"list"===e.view?n("el-table",{staticClass:"file-list__table",attrs:{data:e.files,"current-row-key":"path"},on:{"selection-change":e.updateSelectedFiles}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:e.$t("MEDIA_NAME"),width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"file-item__inner",on:{dblclick:function(n){e.onDoubleClickItem(t.row)}}},[n("span",{staticClass:"file-item__type"},["Folder"===t.row.type?n("font-awesome-icon",{staticClass:"file-item__icon",attrs:{icon:["fal","folder"]}}):n("span",{staticClass:"file-item__thumb",style:{backgroundImage:"url('"+t.row.thumb+"')"}})],1),e._v(" "),n("span",{staticClass:"file-item__name"},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"type",label:e.$t("MEDIA_TYPE")}}),e._v(" "),n("el-table-column",{attrs:{prop:"size",label:e.$t("MEDIA_SIZE")}}),e._v(" "),n("el-table-column",{attrs:{prop:"modified",label:e.$t("MEDIA_MODIFIED_DATE"),formatter:e.formatItemDate}})],1):n("div",{staticClass:"file-list__icon"},e._l(e.files,function(t){return n("label",{key:t.path,staticClass:"file-item",class:{"is-selected":e.selected.indexOf(t.path)>=0}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],staticClass:"file-item__checkbox",attrs:{type:"checkbox"},domProps:{value:t.path,checked:Array.isArray(e.selected)?e._i(e.selected,t.path)>-1:e.selected},on:{change:function(n){var a=e.selected,i=n.target,s=!!i.checked;if(Array.isArray(a)){var r=t.path,o=e._i(a,r);i.checked?o<0&&(e.selected=a.concat([r])):o>-1&&(e.selected=a.slice(0,o).concat(a.slice(o+1)))}else e.selected=s}}}),e._v(" "),n("div",{staticClass:"file-item__inner",on:{dblclick:function(n){e.onDoubleClickItem(t)}}},[n("div",{staticClass:"file-item__type"},["Folder"===t.type?n("font-awesome-icon",{staticClass:"file-item__icon",attrs:{icon:["fal","folder"]}}):n("div",{staticClass:"file-item__thumb",style:{backgroundImage:"url('"+t.thumb+"')"}})],1),e._v(" "),n("div",{staticClass:"file-item__name"},[e._v(e._s(t.name))])])])}))],1)],1),e._v(" "),n("el-footer",{attrs:{height:"40px"}},[n("el-row",{staticClass:"media-footer",attrs:{type:"flex",justify:"space-between"}},[n("el-col",{attrs:{span:6}},[e._v(e._s(e.params.dir))]),e._v(" "),n("el-col",{attrs:{span:12}},[e._v(e._s(e.selected[e.selected.length-1]))]),e._v(" "),e.params.total?n("el-col",{staticClass:"text-right",attrs:{span:6}},[e._v(e._s(e.$t("MEDIA_ITEMS"))+e._s(e.params.total))]):e._e()],1)],1)],1)},staticRenderFns:[]}},SBPZ:function(e,t){throw new Error("Module build failed: Error: Missing binding /Users/daydreamlab/cms-frontend/node_modules/node-sass/vendor/darwin-x64-64/binding.node\nNode Sass could not find a binding for your current environment: OS X 64-bit with Node.js 10.x\n\nFound bindings for the following environments:\n  - OS X 64-bit with Node.js 8.x\n\nThis usually happens because your environment has changed since running `npm install`.\nRun `npm rebuild node-sass` to download the binding for your current environment.\n    at module.exports (/Users/daydreamlab/cms-frontend/node_modules/node-sass/lib/binding.js:15:13)\n    at Object.<anonymous> (/Users/daydreamlab/cms-frontend/node_modules/node-sass/lib/index.js:14:35)\n    at Module._compile (internal/modules/cjs/loader.js:776:30)\n    at Object.Module._extensions..js (internal/modules/cjs/loader.js:787:10)\n    at Module.load (internal/modules/cjs/loader.js:653:32)\n    at tryModuleLoad (internal/modules/cjs/loader.js:593:12)\n    at Function.Module._load (internal/modules/cjs/loader.js:585:3)\n    at Module.require (internal/modules/cjs/loader.js:690:17)\n    at require (internal/modules/cjs/helpers.js:25:18)\n    at Object.sassLoader (/Users/daydreamlab/cms-frontend/node_modules/sass-loader/lib/loader.js:46:72)")},W2nU:function(e,t){var n,a,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{a="function"==typeof clearTimeout?clearTimeout:r}catch(e){a=r}}();var l,c=[],d=!1,u=-1;function f(){d&&l&&(d=!1,l.length?c=l.concat(c):u=-1,c.length&&m())}function m(){if(!d){var e=o(f);d=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===r||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||d||o(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},aP59:function(e,t,n){var a=n("SBPZ");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("6e9ce0da",a,!0,{})},gPVg:function(e,t,n){var a=n("VU/8")(n("Bj2+"),n("EOXh"),!1,function(e){n("aP59")},null,null);e.exports=a.exports},"o/zv":function(e,t,n){(function(e){function n(e,t){for(var n=0,a=e.length-1;a>=0;a--){var i=e[a];"."===i?e.splice(a,1):".."===i?(e.splice(a,1),n++):n&&(e.splice(a,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return a.exec(e).slice(1)};function s(e,t){if(e.filter)return e.filter(t);for(var n=[],a=0;a<e.length;a++)t(e[a],a,e)&&n.push(e[a]);return n}t.resolve=function(){for(var t="",a=!1,i=arguments.length-1;i>=-1&&!a;i--){var r=i>=0?arguments[i]:e.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(t=r+"/"+t,a="/"===r.charAt(0))}return t=n(s(t.split("/"),function(e){return!!e}),!a).join("/"),(a?"/":"")+t||"."},t.normalize=function(e){var a=t.isAbsolute(e),i="/"===r(e,-1);return(e=n(s(e.split("/"),function(e){return!!e}),!a).join("/"))||a||(e="."),e&&i&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(s(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function a(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=a(e.split("/")),s=a(n.split("/")),r=Math.min(i.length,s.length),o=r,l=0;l<r;l++)if(i[l]!==s[l]){o=l;break}var c=[];for(l=o;l<i.length;l++)c.push("..");return(c=c.concat(s.slice(o))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),n=t[0],a=t[1];return n||a?(a&&(a=a.substr(0,a.length-1)),n+a):"."},t.basename=function(e,t){var n=i(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return i(e)[3]};var r="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(t,n("W2nU"))}});