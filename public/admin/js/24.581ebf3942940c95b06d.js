webpackJsonp([24],{"71Dd":function(t,e,n){var i=n("VU/8")(n("7xx+"),n("XF4q"),!1,null,null,null);t.exports=i.exports},"7xx+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("h+Z4"),r=n("b6Cg"),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};e.default={name:"asset-edit",mixins:[i.a,r.a],data:function(){var t=this;return{fields:[{key:"parent_id",type:"select",desc:"請選擇",label:"父级資源",list:this.$store.getters.asset_list,custom_attrs:{label:"tree_title",value:"id"},events:{change:function(e){var n=e.value,i=t.$store.getters.asset_list.filter(function(t){return t.id===n});t.fields[2].prepend_value=i[0].path,t.fields[3].prepend_value=1===n?"src/layout":"views/"}}},{key:"title",desc:"請輸入資源名稱，名稱不可重複",label:"資源名稱"},{key:"path",desc:"開頭須為 /；若為上層預設頁面，請留空",label:"資源訪問路徑",prepend:!0,prepend_value:""},{key:"component",desc:"若上層為根，請勿填寫",label:"資源文件路徑",prepend:!0,prepend_value:"",append:!0,append_value:".vue"},{key:"type",desc:"請輸入資源類型",label:"資源類型",type:"radio",list:[{text:"別名",value:"alias"},{text:"選單",value:"menu"},{text:"選單標頭",value:"separator"},{text:"功能",value:"function"},{text:"外部連結",value:"url"}],events:{change:function(e){var n=e.value;t.default_value.redirect="alias"===n?"noredirect":""}}},{key:"redirect",desc:"請輸入重新導向路徑。若類型為 url 請輸入要連結的網址",label:"重新導向路徑"},{key:"icon",label:"icon",desc:"請輸入icon class"},{key:"state",label:"是否啟用",desc:"",type:"radio",list:[{text:"禁用",value:"0"},{text:"啟用",value:"1"}]},{key:"showNav",label:"顯示在選單",desc:"",type:"radio",list:[{text:"隱藏",value:"0"},{text:"顯示",value:"1"}]}],toolbar:{type:"edit"},default_value:{parent_id:1,title:"",path:"",type:"menu",icon:"",component:"",redirect:"",state:1,showNav:1}}},created:function(){this.onUpdateFieldList(),this.$getFieldList({asset:0})},methods:{onSubmit:function(t){var e=this,n=t.data,i=(t.info,t.type);this.params.id&&(n.id=this.params.id),this.$$api_asset_save({data:n,fn:function(t){var n=t.data,r=t.msg;e.$message.success(r),e.$onSubmitFinish({type:i,query:{id:n.items.id,pid:n.items.parent_id}})}})},onCancel:function(){var t=this;this.$$api_user_getRoutes({fn:function(e){var n=e.data;t.$store.dispatch("update_user_routes",{routes:n.items}).then(function(){t.$router.push({path:t.$route.path.replace("/edit",""),query:t.$router.go(-1)})})}})},onGetView:function(){var t=this;this.$$api_asset_get({pathVar:this.params.id,fn:function(e){var n=e.data;t.default_value=o({},t.default_value,n.items)}})},onUpdateFieldList:function(){1===this.params.pid?this.fields[3].prepend_value="src/layout":this.fields[3].prepend_value="views/"}}}},JeHt:function(t,e,n){"use strict";function i(t){return!(!t||"function"!=typeof t.hasOwnProperty||!(t.hasOwnProperty("__ownerID")||t._map&&t._map.hasOwnProperty("__ownerID")))}function r(t,e,n){return Object.keys(t).reduce(function(e,i){var r=""+i;return e.has(r)?e.set(r,n(e.get(r),t[r])):e},e)}n.d(e,"b",function(){return w}),n.d(e,"a",function(){return O});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},c=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},h=function(t){return function(e){return i(e)?e.get(t):e[t]}},f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(a(this,t),!e||"string"!=typeof e)throw new Error("Expected a string key for Entity, but found "+e+".");var r=i.idAttribute,o=void 0===r?"id":r,s=i.mergeStrategy,c=void 0===s?function(t,e){return u({},t,e)}:s,l=i.processStrategy,f=void 0===l?function(t){return u({},t)}:l;this._key=e,this._getId="function"==typeof o?o:h(o),this._idAttribute=o,this._mergeStrategy=c,this._processStrategy=f,this.define(n)}return t.prototype.define=function(t){this.schema=Object.keys(t).reduce(function(e,n){var i,r=t[n];return u({},e,((i={})[n]=r,i))},this.schema||{})},t.prototype.getId=function(t,e,n){return this._getId(t,e,n)},t.prototype.merge=function(t,e){return this._mergeStrategy(t,e)},t.prototype.normalize=function(t,e,n,i,r){var a=this,s=this._processStrategy(t,e,n);return Object.keys(this.schema).forEach(function(t){if(s.hasOwnProperty(t)&&"object"===o(s[t])){var e=a.schema[t];s[t]=i(s[t],s,t,e,r)}}),r(this,s,t,e,n),this.getId(t,e,n)},t.prototype.denormalize=function(t,e){var n=this;return i(t)?r(this.schema,t,e):(Object.keys(this.schema).forEach(function(i){if(t.hasOwnProperty(i)){var r=n.schema[i];t[i]=e(t[i],r)}}),t)},s(t,[{key:"key",get:function(){return this._key}},{key:"idAttribute",get:function(){return this._idAttribute}}]),t}(),p=function(){function t(e,n){a(this,t),n&&(this._schemaAttribute="string"==typeof n?function(t){return t[n]}:n),this.define(e)}return t.prototype.define=function(t){this.schema=t},t.prototype.getSchemaAttribute=function(t,e,n){return!this.isSingleSchema&&this._schemaAttribute(t,e,n)},t.prototype.inferSchema=function(t,e,n){if(this.isSingleSchema)return this.schema;var i=this.getSchemaAttribute(t,e,n);return this.schema[i]},t.prototype.normalizeValue=function(t,e,n,i,r){var o=this.inferSchema(t,e,n);if(!o)return t;var a=i(t,e,n,o,r);return this.isSingleSchema||void 0===a||null===a?a:{id:a,schema:this.getSchemaAttribute(t,e,n)}},t.prototype.denormalizeValue=function(t,e){var n=i(t)?t.get("schema"):t.schema;if(!this.isSingleSchema&&!n)return t;var r=i(t)?t.get("id"):t.id,o=this.isSingleSchema?this.schema:this.schema[n];return e(r||t,o)},s(t,[{key:"isSingleSchema",get:function(){return!this._schemaAttribute}}]),t}(),d=function(t){function e(n,i){if(a(this,e),!i)throw new Error('Expected option "schemaAttribute" not found on UnionSchema.');return l(this,t.call(this,n,i))}return c(e,t),e.prototype.normalize=function(t,e,n,i,r){return this.normalizeValue(t,e,n,i,r)},e.prototype.denormalize=function(t,e){return this.denormalizeValue(t,e)},e}(p),y=function(t){function e(){return a(this,e),l(this,t.apply(this,arguments))}return c(e,t),e.prototype.normalize=function(t,e,n,i,r){var o=this;return Object.keys(t).reduce(function(e,n,a){var s,c=t[n];return void 0!==c&&null!==c?u({},e,((s={})[n]=o.normalizeValue(c,t,n,i,r),s)):e},{})},e.prototype.denormalize=function(t,e){var n=this;return Object.keys(t).reduce(function(i,r){var o,a=t[r];return u({},i,((o={})[r]=n.denormalizeValue(a,e),o))},{})},e}(p),m=function(t){if(Array.isArray(t)&&t.length>1)throw new Error("Expected schema definition to be a single schema, but found "+t.length+".");return t[0]},v=function(t){return Array.isArray(t)?t:Object.keys(t).map(function(e){return t[e]})},b=function(t,e,n,i,r,o){return t=m(t),v(e).map(function(e,a){return r(e,n,i,t,o)})},g=function(t){function e(){return a(this,e),l(this,t.apply(this,arguments))}return c(e,t),e.prototype.normalize=function(t,e,n,i,r){var o=this;return v(t).map(function(t,a){return o.normalizeValue(t,e,n,i,r)}).filter(function(t){return void 0!==t&&null!==t})},e.prototype.denormalize=function(t,e){var n=this;return t&&t.map?t.map(function(t){return n.denormalizeValue(t,e)}):t},e}(p),_=function(t,e,n,i,r,o){var a=u({},e);return Object.keys(t).forEach(function(n){var i=t[n],s=r(e[n],e,n,i,o);void 0===s||null===s?delete a[n]:a[n]=s}),a},$=function(t,e,n){if(i(e))return r(t,e,n);var o=u({},e);return Object.keys(t).forEach(function(e){o[e]&&(o[e]=n(o[e],t[e]))}),o},S=function(){function t(e){a(this,t),this.define(e)}return t.prototype.define=function(t){this.schema=Object.keys(t).reduce(function(e,n){var i,r=t[n];return u({},e,((i={})[n]=r,i))},this.schema||{})},t.prototype.normalize=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return _.apply(void 0,[this.schema].concat(e))},t.prototype.denormalize=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return $.apply(void 0,[this.schema].concat(e))},t}(),w={Array:g,Entity:f,Object:S,Union:d,Values:y},O=function(t,e){if(!t||"object"!==(void 0===t?"undefined":o(t)))throw new Error('Unexpected input given to normalize. Expected type to be "object", found "'+(void 0===t?"undefined":o(t))+'".');var n={},i=function(t){return function(e,n,i,r,o){var a=e.key,s=e.getId(i,r,o);a in t||(t[a]={});var u=t[a][s];t[a][s]=u?e.merge(u,n):n}}(n);return{entities:n,result:function t(e,n,i,r,a){return"object"===(void 0===e?"undefined":o(e))&&e?"object"!==(void 0===r?"undefined":o(r))||r.normalize&&"function"==typeof r.normalize?r.normalize(e,n,i,t,a):(Array.isArray(r)?b:_)(r,e,n,i,t,a):e}(t,t,null,e,i)}}},XF4q:function(t,e){t.exports={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("FormData",{attrs:{FieldList:this.fields,DefaultValue:this.default_value,Toolbar:this.toolbar},on:{onSubmit:this.onSubmit,onCancel:this.onCancel}})],1)},staticRenderFns:[]}},b6Cg:function(t,e,n){"use strict";e.a={data:function(){return{params:{id:"",pid:""},toolbar:{type:"edit"}}},watch:{$route:function(){this.$initView()}},created:function(){this.$initView()},methods:{$onSubmitFinish:function(t){var e=t.type,n=t.query;switch(e){case"save":this.$router.push({path:this.$route.path,query:n});break;case"savenadd":this.$router.push({path:this.$route.path}),this.$router.go(0);break;case"savenclose":this.$onCancel()}},$onCancel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t&&this.handleCheckout(t),this.$router.push({path:this.$route.path.replace("/edit",""),query:this.$route.query.from})},onUpdateViewParams:function(){this.params.id=parseInt(this.$route.query.id)||"",this.params.pid=parseInt(this.$route.query.pid)||"",this.$set(this.toolbar,"type",this.params.id?"edit":"add")},$initView:function(){this.onUpdateViewParams(),this.params.id&&this.onGetView()}}}},"h+Z4":function(t,e,n){"use strict";var i=n("JeHt");e.a={methods:{$handleGetFieldList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];this.$$api_option_list({data:{types:t},fn:function(o){var a=o.data;t.forEach(function(t){if("extrafield_group"===t){a.items[t].unshift({id:0,value:"",title:e.$t("OPTION_NONE")});var o=new i.b.Entity("groups"),s=Object(i.a)(a.items[t],[o]);e.handleUpdateField(t,s.entities.groups,n[t],r)}else e.handleUpdateField(t,a.items,n[t],r)})}})},$getFieldList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1],i=Object.keys(e).filter(function(e){return!t.checkStoreField(e)});i.length>0&&this.$handleGetFieldList(i,e,n)},handleUpdateField:function(t,e,n,i){this.onUpdateStoreFieldList(t,e[t]||e),i?this.onUpdateSearchbarFieldList(t,n):this.onUpdateFieldList(t,n)},onUpdateFieldList:function(t,e){this.fields[e].list=this.$store.getters[t+"_list"]},onUpdateSearchbarFieldList:function(t,e){this.searchbar.fields[e].list=this.$store.getters[t+"_list"]},onUpdateStoreFieldList:function(t,e){if("language"===t){var n={sef:"*",title:this.$t("ALL_LANGUAGE")};e.unshift(n)}"item_category"!==t&&"menu_category"!==t||(e[0].tree_list_title=e[0].tree_list_title.replace("ROOT",this.$t("GLOBAL_ROOT"))),this.$store.dispatch("update_option_related_list",{type:t,data:e})},checkStoreField:function(t){return Boolean(this.$store.getters[t+"_list"])}}}}});