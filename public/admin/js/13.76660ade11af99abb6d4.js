webpackJsonp([13],{"6D62":function(t,e,i){"use strict";var r=i("JeHt"),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],r=!0,a=!1,n=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);r=!0);}catch(t){a=!0,n=t}finally{try{!r&&o.return&&o.return()}finally{if(a)throw n}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}e.a={methods:{handleUpdateField:function(t,e,i,r){this.updateStoreFieldList(t,e[t]||e),r?this.updateSearchbarFieldList(t,i):this.updateFieldList(t,i)},updateFieldList:function(t,e){this.fields[e].list=this.$store.getters[t+"_list"]},updateSearchbarFieldList:function(t,e){this.searchbar.fields[e].list=this.$store.getters[t+"_list"]},updateStoreFieldList:function(t,e){var i=this;"language"===t&&(e=[{sef:"*",title:this.$t("ALL_LANGUAGE")}].concat(s(e))),"asset"===t&&(e=e.map(function(t){var e=t.tree_list_title.split(" "),r=n(e,2),s=r[0],o=r[1],u=o?s+" "+i.$t(o):i.$t(s);return a({},t,{tree_list_title:u})})),"asset"!==t&&"item_category"!==t&&"menu_category"!==t||(e[0].tree_list_title=e[0].tree_list_title.replace("ROOT",this.$t("GLOBAL_ROOT"))),this.$store.dispatch("update_option_related_list",{type:t,data:e})},$_optionMixin_handleGetFieldList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments[2];this.$$api_option_list({data:{types:t},fn:function(n){var o=n.data;t.forEach(function(t){if("extrafield_group"===t){o.items[t]=[{id:0,value:"",title:e.$t("OPTION_NONE")}].concat(s(o.items[t]));var n=new r.b.Entity("groups"),u=Object(r.a)(o.items[t],[n]);e.handleUpdateField(t,u.entities.groups,i[t],a)}else e.handleUpdateField(t,o.items,i[t],a)})}})},$_optionMixin_updateFieldList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments[1],r=Object.keys(e).filter(function(e){return!t.checkStoreField(e)||"item_article_category"===e||"item_category"===e||"extrafield_group"===e});r.length>0&&this.$_optionMixin_handleGetFieldList(r,e,i)},checkStoreField:function(t){return Boolean(this.$store.getters[t+"_list"])}}}},"8HCM":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-form",{ref:"form-data",staticClass:"form-data",attrs:{"label-position":"top",model:t.defaultValue}},[i("el-form-item",{attrs:{prop:"title",label:t.$t("FIELD_TITLE_LABEL")}},[i("el-input",{model:{value:t.defaultValue.title,callback:function(e){t.$set(t.defaultValue,"title",e)},expression:"defaultValue.title"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"parent_id",label:t.$t("OPTION_PARENT_GROUP")}},[i("el-select",{model:{value:t.defaultValue.parent_id,callback:function(e){t.$set(t.defaultValue,"parent_id",e)},expression:"defaultValue.parent_id"}},t._l(t.fields.parent_id.list,function(e){return i("el-option",{key:e[t.fields.parent_id.custom_attrs.value],attrs:{label:e[t.fields.parent_id.custom_attrs.label],value:e[t.fields.parent_id.custom_attrs.value]}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{prop:"redirect",label:t.$t("OPTION_USER_REDIRECT")}},[i("el-select",{model:{value:t.defaultValue.redirect,callback:function(e){t.$set(t.defaultValue,"redirect",e)},expression:"defaultValue.redirect"}},t._l(t.fields.redirect.list,function(e){return i("el-option",{key:e[t.fields.redirect.custom_attrs.value],attrs:{label:e[t.fields.redirect.custom_attrs.label],value:e[t.fields.redirect.custom_attrs.value]}})}),1)],1),t._v(" "),t._l(t.fields.asset_ids.list,function(e){return[i("el-row",{key:e.id,staticClass:"page-item"},[i("el-col",{attrs:{span:3}},[i("el-checkbox",{attrs:{label:e.id},model:{value:t.defaultValue.asset_ids,callback:function(e){t.$set(t.defaultValue,"asset_ids",e)},expression:"defaultValue.asset_ids"}},[t._v(t._s(t.$t(e.title)))])],1),t._v(" "),i("el-col",{attrs:{span:21}},t._l(e.children,function(e){return i("el-row",{key:e.id,staticClass:"subpage-item"},[i("el-col",{attrs:{span:6}},[i("el-checkbox",{attrs:{label:e.id},model:{value:t.defaultValue.asset_ids,callback:function(e){t.$set(t.defaultValue,"asset_ids",e)},expression:"defaultValue.asset_ids"}},[t._v(t._s(t.$t(e.title)))])],1),t._v(" "),t.fields.api_ids.list[e.id]?i("el-col",{attrs:{span:18}},t._l(t.fields.api_ids.list[e.id],function(r){return i("el-checkbox",{key:e.id+"-"+r.id,attrs:{label:r.id},model:{value:t.defaultValue.api_ids,callback:function(e){t.$set(t.defaultValue,"api_ids",e)},expression:"defaultValue.api_ids"}},[t._v(t._s(r.method))])}),1):t._e()],1)}),1)],1)]})],2)},staticRenderFns:[]}},Cm6Z:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("hgup"),a=i("gcp9");var n=i("6D62"),s=i("X50X"),o=i("JtZj"),u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t};e.default={name:"UserGroupEdit",mixins:[n.a,s.a,o.a],data:function(){return{fields:{parent_id:{list:this.$store.getters.user_group_list,custom_attrs:{label:"tree_list_title",value:"id"}},redirect:{list:this.$store.getters.asset_list,custom_attrs:{label:"tree_list_title",value:"path"}},asset_ids:{list:[],custom_attrs:{label:"tree_list_title",value:"id"}},api_ids:{list:[],custom_attrs:{label:"method",value:"id"}}},defaultValue:{parent_id:1,title:"",redirect:"",state:1,asset_ids:[],api_ids:[]}}},created:function(){this.$_optionMixin_updateFieldList({user_group:"parent_id",asset:"redirect"})},methods:{updateUserPage:function(){var t=this;this.$$api_user_getPages({fn:function(e){var i=e.data.items.assets;t.$store.dispatch("update_user_routes",{routes:i}).then(function(){t.$router.push({path:t.$route.path.replace("/edit","")})})}})},isUsersGroup:function(){return this.$store.state.user.user_info.groups.map(function(t){return t.id}).includes(this.params.id)},handleSubmit:function(t){var e=this,i=t.submit_data,r=t.btn_type;this.params.id&&(i.id=this.params.id),this.$$api_user_saveGroup({data:i,fn:function(t){var a=t.data,n=t.msg;isUsersGroup?e.updateUserPage():e.$_editMixin_onSubmitFinish({msg:n,btn_type:r,query:{id:a?a.items.id:i.id}})}})},handleGetFieldList:function(){var t=this;this.$$api_user_groupPages({pathVar:this.params.pid,fn:function(e){var i=e.data.items,r=i.assets,a=i.apis;t.fields.asset_ids.list=r,t.fields.api_ids.list=a}})},handleGetData:function(){var t=this;this.$$api_user_getGroup({pathVar:this.params.id,fn:function(e){var i,n,s=e.data;t.defaultValue=u({},t.defaultValue,s.items,{api_ids:s.items.apis,asset_ids:s.items.assets}),i="assignAccess",(!(n=r.a.state.user.user_access[a.a.currentRoute.meta.id])||n.includes(i))&&t.handleGetFieldList()}})}}}},JeHt:function(t,e,i){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function n(){return(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}).apply(this,arguments)}function s(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function o(t){return!(!t||"function"!=typeof t.hasOwnProperty||!(t.hasOwnProperty("__ownerID")||t._map&&t._map.hasOwnProperty("__ownerID")))}function u(t,e,i){return Object.keys(t).reduce(function(e,r){var a=""+r;return e.has(a)?e.set(a,i(e.get(a),t[a])):e},e)}i.d(e,"a",function(){return k}),i.d(e,"b",function(){return $});var l=function(t){return function(e){return o(e)?e.get(t):e[t]}},c=function(){function t(t,e,i){if(void 0===e&&(e={}),void 0===i&&(i={}),!t||"string"!=typeof t)throw new Error("Expected a string key for Entity, but found "+t+".");var r=i,a=r.idAttribute,s=void 0===a?"id":a,o=r.mergeStrategy,u=void 0===o?function(t,e){return n({},t,e)}:o,c=r.processStrategy,d=void 0===c?function(t){return n({},t)}:c,f=r.fallbackStrategy,h=void 0===f?function(t,e){}:f;this._key=t,this._getId="function"==typeof s?s:l(s),this._idAttribute=s,this._mergeStrategy=u,this._processStrategy=d,this._fallbackStrategy=h,this.define(e)}var e=t.prototype;return e.define=function(t){this.schema=Object.keys(t).reduce(function(e,i){var r,a=t[i];return n({},e,((r={})[i]=a,r))},this.schema||{})},e.getId=function(t,e,i){return this._getId(t,e,i)},e.merge=function(t,e){return this._mergeStrategy(t,e)},e.fallback=function(t,e){return this._fallbackStrategy(t,e)},e.normalize=function(t,e,i,r,a,n){var s=this,o=this.getId(t,e,i),u=this.key;if(u in n||(n[u]={}),o in n[u]||(n[u][o]=[]),n[u][o].some(function(e){return e===t}))return o;n[u][o].push(t);var l=this._processStrategy(t,e,i);return Object.keys(this.schema).forEach(function(e){if(l.hasOwnProperty(e)&&"object"==typeof l[e]){var i=s.schema[e],o="function"==typeof i?i(t):i;l[e]=r(l[e],l,e,o,a,n)}}),a(this,l,t,e,i),o},e.denormalize=function(t,e){var i=this;return o(t)?u(this.schema,t,e):(Object.keys(this.schema).forEach(function(r){if(t.hasOwnProperty(r)){var a=i.schema[r];t[r]=e(t[r],a)}}),t)},a(t,[{key:"key",get:function(){return this._key}},{key:"idAttribute",get:function(){return this._idAttribute}}]),t}(),d=function(){function t(t,e){e&&(this._schemaAttribute="string"==typeof e?function(t){return t[e]}:e),this.define(t)}var e=t.prototype;return e.define=function(t){this.schema=t},e.getSchemaAttribute=function(t,e,i){return!this.isSingleSchema&&this._schemaAttribute(t,e,i)},e.inferSchema=function(t,e,i){if(this.isSingleSchema)return this.schema;var r=this.getSchemaAttribute(t,e,i);return this.schema[r]},e.normalizeValue=function(t,e,i,r,a,n){var s=this.inferSchema(t,e,i);if(!s)return t;var o=r(t,e,i,s,a,n);return this.isSingleSchema||void 0===o||null===o?o:{id:o,schema:this.getSchemaAttribute(t,e,i)}},e.denormalizeValue=function(t,e){var i=o(t)?t.get("schema"):t.schema;if(!this.isSingleSchema&&!i)return t;var r=this.isSingleSchema?void 0:o(t)?t.get("id"):t.id,a=this.isSingleSchema?this.schema:this.schema[i];return e(r||t,a)},a(t,[{key:"isSingleSchema",get:function(){return!this._schemaAttribute}}]),t}(),f=function(t){function e(e,i){if(!i)throw new Error('Expected option "schemaAttribute" not found on UnionSchema.');return t.call(this,e,i)||this}s(e,t);var i=e.prototype;return i.normalize=function(t,e,i,r,a,n){return this.normalizeValue(t,e,i,r,a,n)},i.denormalize=function(t,e){return this.denormalizeValue(t,e)},e}(d),h=function(t){function e(){return t.apply(this,arguments)||this}s(e,t);var i=e.prototype;return i.normalize=function(t,e,i,r,a,s){var o=this;return Object.keys(t).reduce(function(e,i,u){var l,c=t[i];return void 0!==c&&null!==c?n({},e,((l={})[i]=o.normalizeValue(c,t,i,r,a,s),l)):e},{})},i.denormalize=function(t,e){var i=this;return Object.keys(t).reduce(function(r,a){var s,o=t[a];return n({},r,((s={})[a]=i.denormalizeValue(o,e),s))},{})},e}(d),p=function(t){if(Array.isArray(t)&&t.length>1)throw new Error("Expected schema definition to be a single schema, but found "+t.length+".");return t[0]},m=function(t){return Array.isArray(t)?t:Object.keys(t).map(function(e){return t[e]})},_=function(t,e,i,r,a,n,s){return t=p(t),m(e).map(function(e,o){return a(e,i,r,t,n,s)})},v=function(t){function e(){return t.apply(this,arguments)||this}s(e,t);var i=e.prototype;return i.normalize=function(t,e,i,r,a,n){var s=this;return m(t).map(function(t,o){return s.normalizeValue(t,e,i,r,a,n)}).filter(function(t){return void 0!==t&&null!==t})},i.denormalize=function(t,e){var i=this;return t&&t.map?t.map(function(t){return i.denormalizeValue(t,e)}):t},e}(d),y=function(t,e,i,r,a,s,o){var u=n({},e);return Object.keys(t).forEach(function(i){var r=t[i],n="function"==typeof r?r(e):r,l=a(e[i],e,i,n,s,o);void 0===l||null===l?delete u[i]:u[i]=l}),u},b=function(t,e,i){if(o(e))return u(t,e,i);var r=n({},e);return Object.keys(t).forEach(function(e){null!=r[e]&&(r[e]=i(r[e],t[e]))}),r},g=function t(e,i,r,a,n,s){return"object"==typeof e&&e?"object"!=typeof a||a.normalize&&"function"==typeof a.normalize?a.normalize(e,i,r,t,n,s):(Array.isArray(a)?_:y)(a,e,i,r,t,n,s):e},$={Array:v,Entity:c,Object:function(){function t(t){this.define(t)}var e=t.prototype;return e.define=function(t){this.schema=Object.keys(t).reduce(function(e,i){var r,a=t[i];return n({},e,((r={})[i]=a,r))},this.schema||{})},e.normalize=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return y.apply(void 0,[this.schema].concat(e))},e.denormalize=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return b.apply(void 0,[this.schema].concat(e))},t}(),Union:f,Values:h},k=function(t,e){if(!t||"object"!=typeof t)throw new Error('Unexpected input given to normalize. Expected type to be "object", found "'+(null===t?"null":typeof t)+'".');var i={},r=function(t){return function(e,i,r,a,n){var s=e.key,o=e.getId(r,a,n);s in t||(t[s]={});var u=t[s][o];t[s][o]=u?e.merge(u,i):i}}(i);return{entities:i,result:g(t,t,null,e,r,{})}}},JtZj:function(t,e,i){"use strict";e.a={created:function(){var t=this;this.$$eventBus.$on("onClickCMSFormDataToolbar",function(e){var i=e.type;switch(i){case"cancel":t.$_editMixin_onCancel(t.$route.query.id);break;case"save":case"savenclose":case"savenadd":t.handleSubmit({btn_type:i,submit_data:t.defaultValue});break;case"trash":t.handleTrash()}})},mounted:function(){this.initToolbar(this.toolbar)},beforeDestroy:function(){this.initToolbar(),this.$$eventBus.$off("onClickCMSFormDataToolbar")},methods:{initToolbar:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$$eventBus.$emit("onInitToolbar",{name:"CMSFormData",data:t})}}}},NREM:function(t,e,i){var r=i("VU/8")(i("Cm6Z"),i("8HCM"),!1,function(t){i("obPB")},"data-v-38c3e212",null);t.exports=r.exports},PQST:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,".page-item[data-v-38c3e212]{padding:12px 0;border-top:1px solid #e4e7ed}.subpage-item[data-v-38c3e212]{padding-bottom:12px}.subpage-item[data-v-38c3e212]:not(:last-child){border-bottom:1px solid #e4e7ed;margin-bottom:12px}",""])},X50X:function(t,e,i){"use strict";e.a={data:function(){return{params:{id:"",pid:""},toolbar:{type:"edit"}}},watch:{$route:{immediate:!0,handler:"initData"}},methods:{$_editMixin_onSubmitFinish:function(t){var e=t.msg,i=t.btn_type,r=t.query;switch(this.$message.success(e),i){case"save":this.$router.push({path:this.$route.path,query:r});break;case"savenadd":this.checkRouteNeedCheckout(this.$route.path)&&r.id&&this.handleCheckout(r.id),this.$router.push({path:this.$route.path}),this.$router.go(0);break;case"savenclose":this.$_editMixin_onCancel(r.id)}},$_editMixin_onCancel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.checkRouteNeedCheckout(this.$route.path)&&t&&this.handleCheckout(t),this.$router.push({path:this.$route.path.replace("/edit",""),query:this.$route.query.from})},checkRouteNeedCheckout:function(t){var e=!0,i=!1,r=void 0;try{for(var a,n=["item","category","menu","site"][Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var s=a.value;if(t.includes(s))return!0}}catch(t){i=!0,r=t}finally{try{!e&&n.return&&n.return()}finally{if(i)throw r}}},updateParams:function(){this.params.id=Number(this.$route.query.id)||"",this.params.pid=Number(this.$route.query.pid)||1,this.$set(this.toolbar,"type",this.params.id?"edit":"add")},initData:function(){this.updateParams(),this.params.id&&this.handleGetData()}}}},obPB:function(t,e,i){var r=i("PQST");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);i("rjj0")("012861b9",r,!0,{})}});