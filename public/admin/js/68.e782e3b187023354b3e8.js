webpackJsonp([68],{"1xxR":function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,'.content-container .el-main.media-main{min-height:500px;padding:10px}.content-container .el-aside.media-aside{padding:10px}.content-container .el-tree-node .el-tree-node__content{position:relative;padding-right:2rem}.content-container .el-tree-node .el-tree-node__content .media-tree-node{width:100%}.content-container .el-tree-node .el-tree-node__content .media-tree-node__label{width:100%;overflow:hidden;text-overflow:ellipsis;display:block}.media-container{background:#fff}.media-container .el-footer,.media-container .el-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.media-container .el-header{border-bottom:1px solid #e6e6e6}.media-container .el-footer{border-top:1px solid #e6e6e6;color:#999}.media-container .el-aside{border-right:1px solid #e6e6e6}.media-toolbar__item{margin-right:10px}.media-create__item{margin-bottom:10px}.media-footer{width:100%}.file-list__table .el-table__row{cursor:default}.file-list__table .el-table__row .file-item__thumb{width:1em;height:1em;display:inline-block;vertical-align:middle;background-size:cover;background-color:#e6e6e6}.file-list__icon{color:#606266;padding:10px}.file-list__icon:after,.file-list__icon:before{content:"";display:table}.file-list__icon .file-item__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.file-list__icon .file-item__type{width:3em;height:3em}.file-list__icon .file-item__icon{font-size:3em}.file-list__icon .file-item__thumb{width:100%;height:100%;background-size:cover;background-color:#e6e6e6}.file-list__icon .file-item__name{margin-top:10px;padding:2px 4px;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-height:2.4em;line-height:1.3em;white-space:pre-line;overflow:hidden;overflow-wrap:break-word;word-break:break-word;text-align:center}.file-item{width:120px;height:80px;float:left;padding-right:1.5rem;-webkit-box-sizing:border-box;box-sizing:border-box}.file-item__checkbox{opacity:0;position:absolute}.file-item.is-selected .file-item__name{background:#2f3855;color:#fff;border-radius:4px;max-height:3.8em;-webkit-line-clamp:initial;z-index:1}',""])},"8agu":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticClass:"media-container"},[i("el-header",{staticClass:"media-toolbar"},[i("el-radio-group",{staticClass:"media-toolbar__item",model:{value:e.view,callback:function(t){e.view=t},expression:"view"}},[i("el-radio-button",{attrs:{label:"icon"}},[i("font-awesome-icon",{attrs:{icon:["fal","grip-horizontal"]}}),e._v("\n        "+e._s(e.$t("MEDIA_THUMB_VIEW"))+"\n      ")],1),e._v(" "),i("el-radio-button",{attrs:{label:"list"}},[i("font-awesome-icon",{attrs:{icon:["fal","bars"]}}),e._v("\n        "+e._s(e.$t("MEDIA_LIST_VIEW"))+"\n      ")],1)],1),e._v(" "),i("el-button-group",{staticClass:"media-toolbar__item"},[i("el-button",{attrs:{type:e.showUploadFileBtn?"info":"success"},on:{click:function(t){e.showUploadFileBtn=!e.showUploadFileBtn}}},[e.showUploadFileBtn?[i("font-awesome-icon",{attrs:{icon:["fal","times"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_CANCEL")+e.$t("MEDIA_UPLOAD"))+"\n        ")]:[i("font-awesome-icon",{attrs:{icon:["fal","upload"]}}),e._v("\n          "+e._s(e.$t("MEDIA_UPLOAD"))+"\n        ")]],2)],1),e._v(" "),i("el-button-group",{staticClass:"media-toolbar__item"},[i("el-button",{attrs:{type:e.showCreateFolderBtn?"info":""},on:{click:function(t){e.showCreateFolderBtn=!e.showCreateFolderBtn,e.showRenameFolderBtn=!1}}},[e.showCreateFolderBtn?[i("font-awesome-icon",{attrs:{icon:["fal","times"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_CANCEL")+e.$t("MEDIA_CREATE_DIR"))+"\n        ")]:[i("font-awesome-icon",{attrs:{icon:["fal","plus"]}}),e._v("\n          "+e._s(e.$t("MEDIA_CREATE_DIR"))+"\n        ")]],2),e._v(" "),i("el-button",{attrs:{type:e.showRenameFolderBtn?"info":"",disabled:1!==e.selected.length||"Folder"!==e.lastSelect.type},on:{click:function(t){e.showRenameFolderBtn=!e.showRenameFolderBtn,e.showCreateFolderBtn=!1}}},[e.showRenameFolderBtn?[i("font-awesome-icon",{attrs:{icon:["fal","times"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_CANCEL")+e.$t("TOOLBAR_RENAME_DIR"))+"\n        ")]:[i("font-awesome-icon",{attrs:{icon:["fal","edit"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_RENAME_DIR"))+"\n        ")]],2)],1),e._v(" "),i("el-button-group",{staticClass:"media-toolbar__item"},[i("el-button",{attrs:{disabled:e.selected.length<=0},on:{click:e.handleDeleteFile}},[i("font-awesome-icon",{attrs:{icon:["fal","trash-alt"]}}),e._v("\n        "+e._s(e.$t("TOOLBAR_DELETE"))+"\n      ")],1)],1)],1),e._v(" "),i("el-container",[i("el-aside",{staticClass:"media-aside",attrs:{width:"200px"}},[i("el-tree",{ref:"folderTree",attrs:{"node-key":"path",data:e.folders,props:e.folderTreeProps,"expand-on-click-node":!1,indent:8,"default-expand-all":"","highlight-current":""},on:{"node-click":e.updateParamDir},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;return t.data,i("span",{staticClass:"media-tree-node"},[i("span",{staticClass:"media-tree-node__label",attrs:{title:a.label}},[e._v(e._s(a.label))])])}}])})],1),e._v(" "),i("el-main",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"media-main"},[i("div",{staticClass:"media-create"},[e.showCreateFolderBtn?i("el-input",{staticClass:"media-create__item",model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}},[i("template",{slot:"prepend"},[e._v(e._s(e.params.dir))]),e._v(" "),i("el-button",{attrs:{slot:"append"},on:{click:e.handleCreateFolder},slot:"append"},[e._v(e._s(e.$t("MEDIA_CREATE")))])],2):e._e(),e._v(" "),e.showRenameFolderBtn?i("el-input",{staticClass:"media-create__item",model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}},[i("el-button",{attrs:{slot:"append"},on:{click:e.handleRename},slot:"append"},[e._v(e._s(e.$t("MEDIA_RENAME")))])],1):e._e(),e._v(" "),e.showUploadFileBtn?i("el-upload",{ref:"fileUpload",staticClass:"media-create__item",attrs:{multiple:"",action:"string","http-request":e.handleUploadFiles,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger"},slot:"trigger"},[e._v(e._s(e.$t("MEDIA_SELECT_FILE")))]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleUploadFile}},[e._v(e._s(e.$t("MEDIA_UPLOAD")))]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t("MEDIA_UPLOAD_FILE_LIMIT")))])],1):e._e()],1),e._v(" "),"list"===e.view?i("el-table",{staticClass:"file-list__table",attrs:{data:e.files,"current-row-key":"path"},on:{"selection-change":e.updateSelectedFiles}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:e.$t("MEDIA_NAME"),width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"file-item__inner",on:{dblclick:function(i){return e.onDoubleClickItem(t.row)}}},[i("span",{staticClass:"file-item__type"},["Folder"===t.row.type?i("font-awesome-icon",{staticClass:"file-item__icon",attrs:{icon:["fal","folder"]}}):i("span",{staticClass:"file-item__thumb",style:{backgroundImage:"url('"+t.row.thumb+"')"}})],1),e._v(" "),i("span",{staticClass:"file-item__name"},[e._v(e._s(t.row.name))])])]}}],null,!1,1307195990)}),e._v(" "),i("el-table-column",{attrs:{prop:"type",label:e.$t("MEDIA_TYPE")}}),e._v(" "),i("el-table-column",{attrs:{prop:"size",label:e.$t("MEDIA_SIZE")}}),e._v(" "),i("el-table-column",{attrs:{prop:"modified",label:e.$t("MEDIA_MODIFIED_DATE"),formatter:e.formatItemDate}})],1):i("div",{staticClass:"file-list__icon"},e._l(e.files,function(t){return i("label",{key:t,staticClass:"file-item",class:{"is-selected":e.selected.includes(t)}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],staticClass:"file-item__checkbox",attrs:{type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.selected)?e._i(e.selected,t)>-1:e.selected},on:{change:function(i){var a=e.selected,n=i.target,l=!!n.checked;if(Array.isArray(a)){var o=t,s=e._i(a,o);n.checked?s<0&&(e.selected=a.concat([o])):s>-1&&(e.selected=a.slice(0,s).concat(a.slice(s+1)))}else e.selected=l}}}),e._v(" "),i("div",{staticClass:"file-item__inner",on:{dblclick:function(i){return e.onDoubleClickItem(t)}}},[i("div",{staticClass:"file-item__type"},["Folder"===t.type?i("font-awesome-icon",{staticClass:"file-item__icon",attrs:{icon:["fal","folder"]}}):i("div",{staticClass:"file-item__thumb",style:{backgroundImage:"url('"+t.thumb+"')"}})],1),e._v(" "),i("div",{staticClass:"file-item__name"},[e._v(e._s(t.name))])])])}),0)],1)],1),e._v(" "),i("el-footer",{attrs:{height:"40px"}},[i("el-row",{staticClass:"media-footer",attrs:{type:"flex",justify:"space-between"}},[i("el-col",{attrs:{span:6}},[e._v(e._s(e.params.dir))]),e._v(" "),i("el-col",{attrs:{span:12}},[e._v(e._s(e.lastSelect.path))]),e._v(" "),e.params.total?i("el-col",{staticClass:"text-right",attrs:{span:6}},[e._v(e._s(e.$t("MEDIA_ITEMS"))+e._s(e.params.total))]):e._e()],1)],1)],1)},staticRenderFns:[]}},"Bj2+":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("o/zv"),n=i.n(a);t.default={name:"Media",data:function(){return{params:{dir:"/",path:this.filePath,total:""},view:"list",folders:[],files:[],loading:!1,loadingFolder:!1,selected:[],newFolderName:"",showCreateFolderBtn:!1,showRenameFolderBtn:!1,showUploadFileBtn:!1,folderTreeProps:{label:"name",children:"children"}}},components:{popoverMenu:function(){return i.e(78).then(i.bind(null,"tLYc"))}},props:{filePath:{type:String,default:""}},computed:{lastSelect:function(){return this.selected.length>0?this.selected[this.selected.length-1]:{}}},watch:{selected:function(e){this.$emit("change",e),e.length>0&&(this.showRenameFolderBtn=!1)},"params.dir":function(e){this.$refs.folderTree.setCurrentKey(e)},filePath:function(e){this.params.path=e},view:function(e){this.selected=[]}},created:function(){this.initMedia()},methods:{handleDeleteFile:function(){var e=this,t=this.selected.map(function(e){return e.path});this.$$api_media_delete({data:{paths:t},fn:function(){e.handleGetFolders(),e.resetSelectedFiles()}})},handleRename:function(){var e=this,t=this.lastSelect.path||"",i=t.replace("/",""),a=this.lastSelect.type.toLowerCase();this.$$api_media_rename({data:{dir:t,name:i,rename:this.newFolderName,type:a},fn:function(){e.newFolderName="",e.showRenameFolderBtn=!1,e.handleGetFolders(),e.resetSelectedFiles()}})},updateSelectedFiles:function(e){this.selected=e.map(function(e){return{path:e.path,type:e.type}})},resetSelectedFiles:function(){this.selected=[],this.handleGetFiles()},onDoubleClickItem:function(e){"Folder"===e.type?this.updateParamDir(e):this.updateParamPath(e)},updateParamPath:function(e){this.params.path=e.path},updateParamDir:function(e){this.params.dir=e.path,this.resetSelectedFiles()},handleUploadFile:function(){this.$refs.fileUpload.submit()},handleUploadFiles:function(e){var t=this,i=new FormData;i.append("files[]",e.file),i.append("dir",this.params.dir),this.$$api_media_uploadFile({headers:{"Content-Type":"multipart/form-data"},data:i,fn:function(i){var a=i.msg;t.$message.success(a),e.onSuccess(),t.$refs.fileUpload.clearFiles(),t.showUploadFileBtn=!1,t.handleGetFiles()},errFn:function(i){t.$message.error(i),e.onError()}})},handleCreateFolder:function(){var e=this;this.$$api_media_createFolder({data:{dir:this.params.dir,name:this.newFolderName},fn:function(t){t.data;e.newFolderName="",e.showCreateFolderBtn=!1,e.handleGetFiles(),e.handleGetFolders()}})},handleGetFolders:function(){var e=this;this.loadingFolder=!0,this.$$api_media_listFolder({fn:function(t){var i=t.data;e.loadingFolder=!1,i.items[0].name="/",e.folders=i.items}})},handleGetFiles:function(){var e=this;this.loading=!0,this.$$api_media_listFile({data:{dir:this.params.dir},fn:function(t){var i=t.data;e.files=i.items,e.params.total=i.records,e.loading=!1}})},formatItemDate:function(e){return this.$options.filters.displayDateFormat(e.modified)},initMedia:function(){this.handleGetFolders(),this.params.path&&(this.params.dir=n.a.dirname(this.params.path)||this.params.dir,this.selected.push({path:this.params.path,type:""})),this.handleGetFiles()}}}},gPVg:function(e,t,i){var a=i("VU/8")(i("Bj2+"),i("8agu"),!1,function(e){i("l73C")},null,null);e.exports=a.exports},l73C:function(e,t,i){var a=i("1xxR");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("rjj0")("236bde0e",a,!0,{})},"o/zv":function(e,t,i){(function(e){function i(e,t){for(var i=0,a=e.length-1;a>=0;a--){var n=e[a];"."===n?e.splice(a,1):".."===n?(e.splice(a,1),i++):i&&(e.splice(a,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function a(e,t){if(e.filter)return e.filter(t);for(var i=[],a=0;a<e.length;a++)t(e[a],a,e)&&i.push(e[a]);return i}t.resolve=function(){for(var t="",n=!1,l=arguments.length-1;l>=-1&&!n;l--){var o=l>=0?arguments[l]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,n="/"===o.charAt(0))}return t=i(a(t.split("/"),function(e){return!!e}),!n).join("/"),(n?"/":"")+t||"."},t.normalize=function(e){var l=t.isAbsolute(e),o="/"===n(e,-1);return(e=i(a(e.split("/"),function(e){return!!e}),!l).join("/"))||l||(e="."),e&&o&&(e+="/"),(l?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(a(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,i){function a(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var n=a(e.split("/")),l=a(i.split("/")),o=Math.min(n.length,l.length),s=o,r=0;r<o;r++)if(n[r]!==l[r]){s=r;break}var d=[];for(r=s;r<n.length;r++)d.push("..");return(d=d.concat(l.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,a=-1,n=!0,l=e.length-1;l>=1;--l)if(47===(t=e.charCodeAt(l))){if(!n){a=l;break}}else n=!1;return-1===a?i?"/":".":i&&1===a?"/":e.slice(0,a)},t.basename=function(e,t){var i=function(e){"string"!=typeof e&&(e+="");var t,i=0,a=-1,n=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!n){i=t+1;break}}else-1===a&&(n=!1,a=t+1);return-1===a?"":e.slice(i,a)}(e);return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,i=0,a=-1,n=!0,l=0,o=e.length-1;o>=0;--o){var s=e.charCodeAt(o);if(47!==s)-1===a&&(n=!1,a=o+1),46===s?-1===t?t=o:1!==l&&(l=1):-1!==t&&(l=-1);else if(!n){i=o+1;break}}return-1===t||-1===a||0===l||1===l&&t===a-1&&t===i+1?"":e.slice(t,a)};var n="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(t,i("W2nU"))}});