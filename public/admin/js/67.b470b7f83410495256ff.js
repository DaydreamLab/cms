webpackJsonp([67],{"Bj2+":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("o/zv"),a=i.n(n);t.default={name:"Media",data:function(){return{params:{dir:"/",path:this.filePath,total:""},view:"list",folders:[],files:[],loading:!1,loadingFolder:!1,selected:[],newFolderName:"",showCreateFolderBtn:!1,showUploadFileBtn:!1,folderTreeProps:{label:"name",children:"children"}}},components:{popoverMenu:function(){return i.e(78).then(i.bind(null,"tLYc"))}},props:{filePath:{type:String,default:""}},watch:{selected:function(e){this.$emit("change",e)},"params.dir":function(e){this.$refs.folderTree.setCurrentKey(e)},filePath:function(e){this.params.path=e}},created:function(){this.initMedia()},methods:{handleDeleteFolder:function(e,t){var i=this;"/"===t.path||this.loadingFolder||this.$confirm(this.$t("GLOBAL_CONFIRM_DELETE"),{type:"warning"}).then(function(){i.loadingFolder=!0,i.$$api_media_delete({data:{paths:[t.path]},fn:function(){i.loadingFolder=!1,i.handleGetFolders(),i.handleGetFiles()}})})},handleDeleteFile:function(){var e=this;this.$$api_media_delete({data:{paths:this.selected},fn:function(){e.resetSelectedFiles()}})},updateSelectedFiles:function(e){this.selected=e.map(function(e){return e.path})},resetSelectedFiles:function(){this.selected=[],this.handleGetFiles()},onDoubleClickItem:function(e){"Folder"===e.type?this.updateParamDir(e):this.updateParamPath(e)},updateParamPath:function(e){this.params.path=e.path},updateParamDir:function(e){this.params.dir=e.path,this.resetSelectedFiles()},handleUploadFile:function(){this.$refs.fileUpload.submit()},handleUploadFiles:function(e){var t=this,i=new FormData;i.append("files[]",e.file),i.append("dir",this.params.dir),this.$$api_media_uploadFile({headers:{"Content-Type":"multipart/form-data"},data:i,fn:function(i){var n=i.msg;t.$message.success(n),e.onSuccess(),t.$refs.fileUpload.clearFiles(),t.showUploadFileBtn=!1,t.handleGetFiles()},errFn:function(i){t.$message.error(i),e.onError()}})},handleCreateFolder:function(){var e=this;this.$$api_media_createFolder({data:{dir:this.params.dir,name:this.newFolderName},fn:function(t){t.data;e.newFolderName="",e.showCreateFolderBtn=!1,e.handleGetFiles(),e.handleGetFolders()}})},handleGetFolders:function(){var e=this;this.loadingFolder=!0,this.$$api_media_listFolder({fn:function(t){var i=t.data;e.loadingFolder=!1,i.items[0].name="/",e.folders=i.items}})},handleGetFiles:function(){var e=this;this.loading=!0,this.$$api_media_listFile({data:{dir:this.params.dir},fn:function(t){var i=t.data;e.files=i.items,e.params.total=i.records,e.loading=!1}})},formatItemDate:function(e){return this.$options.filters.displayDateFormat(e.modified)},initMedia:function(){this.handleGetFolders(),this.params.path&&(this.params.dir=a.a.dirname(this.params.path)||this.params.dir,this.selected.push(this.params.path)),this.handleGetFiles()}}}},W2nU:function(e,t){var i,n,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function l(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(e){i=o}try{n="function"==typeof clearTimeout?clearTimeout:r}catch(e){n=r}}();var s,c=[],d=!1,f=-1;function u(){d&&s&&(d=!1,s.length?c=s.concat(c):f=-1,c.length&&p())}function p(){if(!d){var e=l(u);d=!0;for(var t=c.length;t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,d=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===r||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new m(e,t)),1!==c.length||d||l(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},aghA:function(e,t,i){(e.exports=i("FZ+f")(!1)).push([e.i,'.content-container .el-main.media-main{min-height:500px;padding:10px}.content-container .el-aside.media-aside{padding:10px}.el-tree-node .el-tree-node__content{position:relative;padding-right:3rem}.el-tree-node .el-tree-node__content .media-tree-node{width:100%}.el-tree-node .el-tree-node__content .media-tree-node__label{width:100%;overflow:hidden;text-overflow:ellipsis;display:block}.el-tree-node .el-tree-node__content .media-tree-node__icon-box{opacity:0;position:absolute;right:0;top:50%;margin-top:-14px;padding-left:10px;padding-right:5px}.el-tree-node .el-tree-node__content:hover .media-tree-node__icon-box{opacity:1}.media-container{background:#fff}.media-container .el-footer,.media-container .el-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.media-container .el-header{border-bottom:1px solid #e6e6e6}.media-container .el-footer{border-top:1px solid #e6e6e6;color:#999}.media-container .el-aside{border-right:1px solid #e6e6e6}.media-toolbar__item{margin-right:10px}.media-create__item{margin-bottom:10px}.media-footer{width:100%}.file-list__table .el-table__row{cursor:default}.file-list__table .el-table__row .file-item__thumb{width:1em;height:1em;display:inline-block;vertical-align:middle;background-size:cover;background-color:#e6e6e6}.file-list__icon{color:#606266;padding:10px}.file-list__icon:after,.file-list__icon:before{content:"";display:table}.file-list__icon .file-item__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.file-list__icon .file-item__type{width:3em;height:3em}.file-list__icon .file-item__icon{font-size:3em}.file-list__icon .file-item__thumb{width:100%;height:100%;background-size:cover;background-color:#e6e6e6}.file-list__icon .file-item__name{margin-top:10px;padding:2px 4px;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-height:2.4em;line-height:1.3em;white-space:pre-line;overflow:hidden;overflow-wrap:break-word;word-break:break-word;text-align:center}.file-item{width:120px;height:80px;float:left;padding-right:1.5rem;-webkit-box-sizing:border-box;box-sizing:border-box}.file-item__checkbox{opacity:0;position:absolute}.file-item.is-selected .file-item__name{background:#2f3855;color:#fff;border-radius:4px;max-height:3.8em;-webkit-line-clamp:initial;z-index:1}',""])},dimB:function(e,t,i){var n=i("aghA");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("06109f0a",n,!0,{})},gPVg:function(e,t,i){var n=i("VU/8")(i("Bj2+"),i("xbmf"),!1,function(e){i("dimB")},null,null);e.exports=n.exports},"o/zv":function(e,t,i){(function(e){function i(e,t){for(var i=0,n=e.length-1;n>=0;n--){var a=e[n];"."===a?e.splice(n,1):".."===a?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,a=function(e){return n.exec(e).slice(1)};function o(e,t){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}t.resolve=function(){for(var t="",n=!1,a=arguments.length-1;a>=-1&&!n;a--){var r=a>=0?arguments[a]:e.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(t=r+"/"+t,n="/"===r.charAt(0))}return t=i(o(t.split("/"),function(e){return!!e}),!n).join("/"),(n?"/":"")+t||"."},t.normalize=function(e){var n=t.isAbsolute(e),a="/"===r(e,-1);return(e=i(o(e.split("/"),function(e){return!!e}),!n).join("/"))||n||(e="."),e&&a&&(e+="/"),(n?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(o(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,i){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var a=n(e.split("/")),o=n(i.split("/")),r=Math.min(a.length,o.length),l=r,s=0;s<r;s++)if(a[s]!==o[s]){l=s;break}var c=[];for(s=l;s<a.length;s++)c.push("..");return(c=c.concat(o.slice(l))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=a(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},t.basename=function(e,t){var i=a(e)[2];return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){return a(e)[3]};var r="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(t,i("W2nU"))},xbmf:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",{staticClass:"media-container"},[i("el-header",{staticClass:"media-toolbar"},[i("el-radio-group",{staticClass:"media-toolbar__item",model:{value:e.view,callback:function(t){e.view=t},expression:"view"}},[i("el-radio-button",{attrs:{label:"icon"}},[i("font-awesome-icon",{attrs:{icon:["fal","grip-horizontal"]}}),e._v("\n        "+e._s(e.$t("MEDIA_THUMB_VIEW"))+"\n      ")],1),e._v(" "),i("el-radio-button",{attrs:{label:"list"}},[i("font-awesome-icon",{attrs:{icon:["fal","bars"]}}),e._v("\n        "+e._s(e.$t("MEDIA_LIST_VIEW"))+"\n      ")],1)],1),e._v(" "),i("el-button-group",{staticClass:"media-toolbar__item"},[i("el-button",{attrs:{type:e.showUploadFileBtn?"info":"success"},on:{click:function(t){e.showUploadFileBtn=!e.showUploadFileBtn}}},[e.showUploadFileBtn?[i("font-awesome-icon",{attrs:{icon:["fal","times"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_CANCEL")+e.$t("MEDIA_UPLOAD"))+"\n        ")]:[i("font-awesome-icon",{attrs:{icon:["fal","upload"]}}),e._v("\n          "+e._s(e.$t("MEDIA_UPLOAD"))+"\n        ")]],2),e._v(" "),i("el-button",{attrs:{type:e.showCreateFolderBtn?"info":""},on:{click:function(t){e.showCreateFolderBtn=!e.showCreateFolderBtn}}},[e.showCreateFolderBtn?[i("font-awesome-icon",{attrs:{icon:["fal","times"]}}),e._v("\n          "+e._s(e.$t("TOOLBAR_CANCEL")+e.$t("MEDIA_CREATE_DIR"))+"\n        ")]:[i("font-awesome-icon",{attrs:{icon:["fal","plus"]}}),e._v("\n          "+e._s(e.$t("MEDIA_CREATE_DIR"))+"\n        ")]],2)],1),e._v(" "),i("el-button-group",{staticClass:"media-toolbar__item"},[i("el-button",{attrs:{disabled:e.selected.length<=0},on:{click:e.handleDeleteFile}},[i("font-awesome-icon",{attrs:{icon:["fal","trash-alt"]}}),e._v("\n        "+e._s(e.$t("TOOLBAR_DELETE"))+"\n      ")],1)],1)],1),e._v(" "),i("el-container",[i("el-aside",{staticClass:"media-aside",attrs:{width:"200px"}},[i("el-tree",{ref:"folderTree",attrs:{"node-key":"path",data:e.folders,props:e.folderTreeProps,"expand-on-click-node":!1,indent:8,"default-expand-all":"","highlight-current":""},on:{"node-click":e.updateParamDir},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,a=t.data;return i("span",{staticClass:"media-tree-node"},[i("span",{staticClass:"media-tree-node__label",attrs:{title:n.label}},[e._v(e._s(n.label))]),e._v(" "),1===n.level||e.loadingFolder?e._e():i("span",{staticClass:"media-tree-node__icon-box"},[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.handleDeleteFolder(n,a)}}},[i("font-awesome-icon",{staticClass:"media-tree-node__icon",attrs:{icon:["fal","times"]}})],1)],1)])}}])})],1),e._v(" "),i("el-main",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"media-main"},[i("div",{staticClass:"media-create"},[e.showCreateFolderBtn?i("el-input",{staticClass:"media-create__item",model:{value:e.newFolderName,callback:function(t){e.newFolderName=t},expression:"newFolderName"}},[i("template",{slot:"prepend"},[e._v(e._s(e.params.dir))]),e._v(" "),i("el-button",{attrs:{slot:"append"},on:{click:e.handleCreateFolder},slot:"append"},[e._v(e._s(e.$t("MEDIA_CREATE")))])],2):e._e(),e._v(" "),e.showUploadFileBtn?i("el-upload",{ref:"fileUpload",staticClass:"media-create__item",attrs:{multiple:"",action:"string","http-request":e.handleUploadFiles,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger"},slot:"trigger"},[e._v(e._s(e.$t("MEDIA_SELECT_FILE")))]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleUploadFile}},[e._v(e._s(e.$t("MEDIA_UPLOAD")))]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.$t("MEDIA_UPLOAD_FILE_LIMIT")))])],1):e._e()],1),e._v(" "),"list"===e.view?i("el-table",{staticClass:"file-list__table",attrs:{data:e.files,"current-row-key":"path"},on:{"selection-change":e.updateSelectedFiles}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:e.$t("MEDIA_NAME"),width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"file-item__inner",on:{dblclick:function(i){e.onDoubleClickItem(t.row)}}},[i("span",{staticClass:"file-item__type"},["Folder"===t.row.type?i("font-awesome-icon",{staticClass:"file-item__icon",attrs:{icon:["fal","folder"]}}):i("span",{staticClass:"file-item__thumb",style:{backgroundImage:"url('"+t.row.thumb+"')"}})],1),e._v(" "),i("span",{staticClass:"file-item__name"},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"type",label:e.$t("MEDIA_TYPE")}}),e._v(" "),i("el-table-column",{attrs:{prop:"size",label:e.$t("MEDIA_SIZE")}}),e._v(" "),i("el-table-column",{attrs:{prop:"modified",label:e.$t("MEDIA_MODIFIED_DATE"),formatter:e.formatItemDate}})],1):i("div",{staticClass:"file-list__icon"},e._l(e.files,function(t){return i("label",{key:t.path,staticClass:"file-item",class:{"is-selected":e.selected.indexOf(t.path)>=0}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],staticClass:"file-item__checkbox",attrs:{type:"checkbox"},domProps:{value:t.path,checked:Array.isArray(e.selected)?e._i(e.selected,t.path)>-1:e.selected},on:{change:function(i){var n=e.selected,a=i.target,o=!!a.checked;if(Array.isArray(n)){var r=t.path,l=e._i(n,r);a.checked?l<0&&(e.selected=n.concat([r])):l>-1&&(e.selected=n.slice(0,l).concat(n.slice(l+1)))}else e.selected=o}}}),e._v(" "),i("div",{staticClass:"file-item__inner",on:{dblclick:function(i){e.onDoubleClickItem(t)}}},[i("div",{staticClass:"file-item__type"},["Folder"===t.type?i("font-awesome-icon",{staticClass:"file-item__icon",attrs:{icon:["fal","folder"]}}):i("div",{staticClass:"file-item__thumb",style:{backgroundImage:"url('"+t.thumb+"')"}})],1),e._v(" "),i("div",{staticClass:"file-item__name"},[e._v(e._s(t.name))])])])}))],1)],1),e._v(" "),i("el-footer",{attrs:{height:"40px"}},[i("el-row",{staticClass:"media-footer",attrs:{type:"flex",justify:"space-between"}},[i("el-col",{attrs:{span:6}},[e._v(e._s(e.params.dir))]),e._v(" "),i("el-col",{attrs:{span:12}},[e._v(e._s(e.selected[e.selected.length-1]))]),e._v(" "),e.params.total?i("el-col",{staticClass:"text-right",attrs:{span:6}},[e._v(e._s(e.$t("MEDIA_ITEMS"))+e._s(e.params.total))]):e._e()],1)],1)],1)},staticRenderFns:[]}}});