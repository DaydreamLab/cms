webpackJsonp([18],{"43l3":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",[r("el-main",[r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{attrs:{label:t.$t("USER_TAB_DETAIL")}},[r("el-form",{ref:"form-data",attrs:{"label-position":"top",rules:t.rule_data,model:t.defaultValue}},[r("el-form-item",{attrs:{label:t.$t("USER_OPTION_ACTIVE")}},[r("el-switch",{attrs:{"active-text":t.$t("YES"),"active-value":1,"inactive-text":t.$t("NO"),"inactive-value":0},model:{value:t.defaultValue.activation,callback:function(e){t.$set(t.defaultValue,"activation",e)},expression:"defaultValue.activation"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"first_name",label:t.$t("USER_FIELD_FIRST_NAME")}},[r("el-input",{model:{value:t.defaultValue.first_name,callback:function(e){t.$set(t.defaultValue,"first_name",e)},expression:"defaultValue.first_name"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"last_name",label:t.$t("USER_FIELD_LAST_NAME")}},[r("el-input",{model:{value:t.defaultValue.last_name,callback:function(e){t.$set(t.defaultValue,"last_name",e)},expression:"defaultValue.last_name"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"email",label:t.$t("USER_FIELD_EMAIL")}},[r("el-input",{model:{value:t.defaultValue.email,callback:function(e){t.$set(t.defaultValue,"email",e)},expression:"defaultValue.email"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"password",label:t.$t("USER_FIELD_PASSWORD")+" ( 8~16 碼英文或數字 )"}},[r("el-input",{model:{value:t.defaultValue.password,callback:function(e){t.$set(t.defaultValue,"password",e)},expression:"defaultValue.password"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:"password_confirmation",label:t.$t("USER_FIELD_PASSWORD_CONFIRMATION")}},[r("el-input",{model:{value:t.defaultValue.password_confirmation,callback:function(e){t.$set(t.defaultValue,"password_confirmation",e)},expression:"defaultValue.password_confirmation"}})],1)],1)],1),t._v(" "),r("el-tab-pane",{attrs:{label:t.$t("USER_TAB_ASSIGN_GROUP")}},[r("el-form",{ref:"form-data",attrs:{"label-position":"top",model:t.defaultValue}},[r("el-form-item",{attrs:{prop:"group_ids"}},[r("el-tree",{ref:"groupTree",attrs:{data:t.fields.group_ids.list,"default-checked-keys":t.defaultValue.group_ids,"default-expanded-keys":t.defaultValue.group_ids,props:t.fields.group_ids.custom_attrs,"node-key":"id","check-strictly":"","show-checkbox":""},on:{"check-change":t.onCheckGroupChange}})],1)],1)],1)],1)],1)],1)},staticRenderFns:[]}},"6D62":function(t,e,r){"use strict";var i=r("JeHt"),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){n=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function o(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}e.a={methods:{handleUpdateField:function(t,e,r,i){this.updateStoreFieldList(t,e[t]||e),i?this.updateSearchbarFieldList(t,r):this.updateFieldList(t,r)},updateFieldList:function(t,e){this.fields[e].list=this.$store.getters[t+"_list"]},updateSearchbarFieldList:function(t,e){this.searchbar.fields[e].list=this.$store.getters[t+"_list"]},updateStoreFieldList:function(t,e){var r=this;"language"===t&&(e=[{sef:"*",title:this.$t("ALL_LANGUAGE")}].concat(o(e))),"asset"===t&&(e=e.map(function(t){var e=t.tree_list_title.split(" "),i=a(e,2),o=i[0],s=i[1],u=s?o+" "+r.$t(s):r.$t(o);return n({},t,{tree_list_title:u})})),"asset"!==t&&"item_category"!==t&&"menu_category"!==t||(e[0].tree_list_title=e[0].tree_list_title.replace("ROOT",this.$t("GLOBAL_ROOT"))),this.$store.dispatch("update_option_related_list",{type:t,data:e})},$_optionMixin_handleGetFieldList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];this.$$api_option_list({data:{types:t},fn:function(a){var s=a.data;t.forEach(function(t){if("extrafield_group"===t){s.items[t]=[{id:0,value:"",title:e.$t("OPTION_NONE")}].concat(o(s.items[t]));var a=new i.b.Entity("groups"),u=Object(i.a)(s.items[t],[a]);e.handleUpdateField(t,u.entities.groups,r[t],n)}else e.handleUpdateField(t,s.items,r[t],n)})}})},$_optionMixin_updateFieldList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1],i=Object.keys(e).filter(function(e){return!t.checkStoreField(e)||"item_article_category"===e||"item_category"===e||"extrafield_group"===e});i.length>0&&this.$_optionMixin_handleGetFieldList(i,e,r)},checkStoreField:function(t){return Boolean(this.$store.getters[t+"_list"])}}}},A37C:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("6D62"),n=r("X50X"),a=r("JtZj"),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.default={name:"UserEdit",mixins:[i.a,n.a,a.a],data:function(){var t=this;return{fields:{group_ids:{list:[],custom_attrs:{children:"children",label:"title"}}},defaultValue:{first_name:"",last_name:"",email:"",password:"",password_confirmation:"",reset_password:"0",group_ids:[],activation:1,block:0},rule_data:{email:[{validator:function(e,r,i){""===r?i(new Error(t.$t("ERROR_PLEASE_ENTER_USER_NAME"))):i()},trigger:"blur"},{type:"email",message:this.$t("ERROR_PLEASE_ENTER_VALID_EMAIL"),trigger:"blur"}],password:[{validator:function(e,r,i){r.length<8||r.length>16?i(new Error(t.$t("ERROR_PLEASE_ENTER_VALID_PASSWORD"))):i()},trigger:"blur"}],password_confirmation:[{validator:function(e,r,i){r!==t.defaultValue.password?i(new Error(t.$t("ERROR_PLEASE_ENTER_PASSWORD_CONFIRMATION"))):i()},trigger:"blur"}]}}},created:function(){this.handleGetFieldList()},methods:{handleTrash:function(){var t=this;this.$$api_user_updateBlock({data:{ids:[this.params.id],block:1},fn:function(e){var r=e.msg;t.$message.success(r),t.$_editMixin_onCancel()}})},handleSubmit:function(t){var e=this,r=t.submit_data,i=t.btn_type;this.params.id&&(r.id=this.params.id),this.$$api_user_save({data:r,fn:function(t){var n=t.data,a=t.msg;e.$_editMixin_onSubmitFinish({msg:a,btn_type:i,query:{id:n?n.items.id:r.id}})}})},onCheckGroupChange:function(){this.defaultValue.group_ids=this.$refs.groupTree.getCheckedKeys()},handleGetData:function(){var t=this;this.$$api_user_get({pathVar:this.params.id,fn:function(e){var r=e.data;t.defaultValue=o({},t.defaultValue,r.items,{group_ids:r.items.groups.map(function(t){return t.id})})}})},handleGetFieldList:function(){var t=this;this.$$api_user_listTreeGroup({fn:function(e){var r=e.data;t.fields.group_ids.list=r.items}})}}}},JeHt:function(t,e,r){"use strict";function i(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}).apply(this,arguments)}function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function s(t){return!(!t||"function"!=typeof t.hasOwnProperty||!(t.hasOwnProperty("__ownerID")||t._map&&t._map.hasOwnProperty("__ownerID")))}function u(t,e,r){return Object.keys(t).reduce(function(e,i){var n=""+i;return e.has(n)?e.set(n,r(e.get(n),t[n])):e},e)}r.d(e,"a",function(){return S}),r.d(e,"b",function(){return $});var l=function(t){return function(e){return s(e)?e.get(t):e[t]}},c=function(){function t(t,e,r){if(void 0===e&&(e={}),void 0===r&&(r={}),!t||"string"!=typeof t)throw new Error("Expected a string key for Entity, but found "+t+".");var i=r,n=i.idAttribute,o=void 0===n?"id":n,s=i.mergeStrategy,u=void 0===s?function(t,e){return a({},t,e)}:s,c=i.processStrategy,f=void 0===c?function(t){return a({},t)}:c,d=i.fallbackStrategy,h=void 0===d?function(t,e){}:d;this._key=t,this._getId="function"==typeof o?o:l(o),this._idAttribute=o,this._mergeStrategy=u,this._processStrategy=f,this._fallbackStrategy=h,this.define(e)}var e=t.prototype;return e.define=function(t){this.schema=Object.keys(t).reduce(function(e,r){var i,n=t[r];return a({},e,((i={})[r]=n,i))},this.schema||{})},e.getId=function(t,e,r){return this._getId(t,e,r)},e.merge=function(t,e){return this._mergeStrategy(t,e)},e.fallback=function(t,e){return this._fallbackStrategy(t,e)},e.normalize=function(t,e,r,i,n,a){var o=this,s=this.getId(t,e,r),u=this.key;if(u in a||(a[u]={}),s in a[u]||(a[u][s]=[]),a[u][s].some(function(e){return e===t}))return s;a[u][s].push(t);var l=this._processStrategy(t,e,r);return Object.keys(this.schema).forEach(function(e){if(l.hasOwnProperty(e)&&"object"==typeof l[e]){var r=o.schema[e],s="function"==typeof r?r(t):r;l[e]=i(l[e],l,e,s,n,a)}}),n(this,l,t,e,r),s},e.denormalize=function(t,e){var r=this;return s(t)?u(this.schema,t,e):(Object.keys(this.schema).forEach(function(i){if(t.hasOwnProperty(i)){var n=r.schema[i];t[i]=e(t[i],n)}}),t)},n(t,[{key:"key",get:function(){return this._key}},{key:"idAttribute",get:function(){return this._idAttribute}}]),t}(),f=function(){function t(t,e){e&&(this._schemaAttribute="string"==typeof e?function(t){return t[e]}:e),this.define(t)}var e=t.prototype;return e.define=function(t){this.schema=t},e.getSchemaAttribute=function(t,e,r){return!this.isSingleSchema&&this._schemaAttribute(t,e,r)},e.inferSchema=function(t,e,r){if(this.isSingleSchema)return this.schema;var i=this.getSchemaAttribute(t,e,r);return this.schema[i]},e.normalizeValue=function(t,e,r,i,n,a){var o=this.inferSchema(t,e,r);if(!o)return t;var s=i(t,e,r,o,n,a);return this.isSingleSchema||void 0===s||null===s?s:{id:s,schema:this.getSchemaAttribute(t,e,r)}},e.denormalizeValue=function(t,e){var r=s(t)?t.get("schema"):t.schema;if(!this.isSingleSchema&&!r)return t;var i=this.isSingleSchema?void 0:s(t)?t.get("id"):t.id,n=this.isSingleSchema?this.schema:this.schema[r];return e(i||t,n)},n(t,[{key:"isSingleSchema",get:function(){return!this._schemaAttribute}}]),t}(),d=function(t){function e(e,r){if(!r)throw new Error('Expected option "schemaAttribute" not found on UnionSchema.');return t.call(this,e,r)||this}o(e,t);var r=e.prototype;return r.normalize=function(t,e,r,i,n,a){return this.normalizeValue(t,e,r,i,n,a)},r.denormalize=function(t,e){return this.denormalizeValue(t,e)},e}(f),h=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var r=e.prototype;return r.normalize=function(t,e,r,i,n,o){var s=this;return Object.keys(t).reduce(function(e,r,u){var l,c=t[r];return void 0!==c&&null!==c?a({},e,((l={})[r]=s.normalizeValue(c,t,r,i,n,o),l)):e},{})},r.denormalize=function(t,e){var r=this;return Object.keys(t).reduce(function(i,n){var o,s=t[n];return a({},i,((o={})[n]=r.denormalizeValue(s,e),o))},{})},e}(f),p=function(t){if(Array.isArray(t)&&t.length>1)throw new Error("Expected schema definition to be a single schema, but found "+t.length+".");return t[0]},m=function(t){return Array.isArray(t)?t:Object.keys(t).map(function(e){return t[e]})},_=function(t,e,r,i,n,a,o){return t=p(t),m(e).map(function(e,s){return n(e,r,i,t,a,o)})},v=function(t){function e(){return t.apply(this,arguments)||this}o(e,t);var r=e.prototype;return r.normalize=function(t,e,r,i,n,a){var o=this;return m(t).map(function(t,s){return o.normalizeValue(t,e,r,i,n,a)}).filter(function(t){return void 0!==t&&null!==t})},r.denormalize=function(t,e){var r=this;return t&&t.map?t.map(function(t){return r.denormalizeValue(t,e)}):t},e}(f),y=function(t,e,r,i,n,o,s){var u=a({},e);return Object.keys(t).forEach(function(r){var i=t[r],a="function"==typeof i?i(e):i,l=n(e[r],e,r,a,o,s);void 0===l||null===l?delete u[r]:u[r]=l}),u},b=function(t,e,r){if(s(e))return u(t,e,r);var i=a({},e);return Object.keys(t).forEach(function(e){null!=i[e]&&(i[e]=r(i[e],t[e]))}),i},g=function t(e,r,i,n,a,o){return"object"==typeof e&&e?"object"!=typeof n||n.normalize&&"function"==typeof n.normalize?n.normalize(e,r,i,t,a,o):(Array.isArray(n)?_:y)(n,e,r,i,t,a,o):e},$={Array:v,Entity:c,Object:function(){function t(t){this.define(t)}var e=t.prototype;return e.define=function(t){this.schema=Object.keys(t).reduce(function(e,r){var i,n=t[r];return a({},e,((i={})[r]=n,i))},this.schema||{})},e.normalize=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return y.apply(void 0,[this.schema].concat(e))},e.denormalize=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return b.apply(void 0,[this.schema].concat(e))},t}(),Union:d,Values:h},S=function(t,e){if(!t||"object"!=typeof t)throw new Error('Unexpected input given to normalize. Expected type to be "object", found "'+(null===t?"null":typeof t)+'".');var r={},i=function(t){return function(e,r,i,n,a){var o=e.key,s=e.getId(i,n,a);o in t||(t[o]={});var u=t[o][s];t[o][s]=u?e.merge(u,r):r}}(r);return{entities:r,result:g(t,t,null,e,i,{})}}},JtZj:function(t,e,r){"use strict";e.a={created:function(){var t=this;this.$$eventBus.$on("onClickCMSFormDataToolbar",function(e){var r=e.type;switch(r){case"cancel":t.$_editMixin_onCancel(t.$route.query.id);break;case"save":case"savenclose":case"savenadd":t.handleSubmit({btn_type:r,submit_data:t.defaultValue});break;case"trash":t.handleTrash()}})},mounted:function(){this.initToolbar(this.toolbar)},beforeDestroy:function(){this.initToolbar(),this.$$eventBus.$off("onClickCMSFormDataToolbar")},methods:{initToolbar:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$$eventBus.$emit("onInitToolbar",{name:"CMSFormData",data:t})}}}},X50X:function(t,e,r){"use strict";e.a={data:function(){return{params:{id:"",pid:""},toolbar:{type:"edit"}}},watch:{$route:{immediate:!0,handler:"initData"}},methods:{$_editMixin_onSubmitFinish:function(t){var e=t.msg,r=t.btn_type,i=t.query;switch(this.$message.success(e),r){case"save":this.$router.push({path:this.$route.path,query:i});break;case"savenadd":this.checkRouteNeedCheckout(this.$route.path)&&i.id&&this.handleCheckout(i.id),this.$router.push({path:this.$route.path}),this.$router.go(0);break;case"savenclose":this.$_editMixin_onCancel(i.id)}},$_editMixin_onCancel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.checkRouteNeedCheckout(this.$route.path)&&t&&this.handleCheckout(t),this.$router.push({path:this.$route.path.replace("/edit",""),query:this.$route.query.from})},checkRouteNeedCheckout:function(t){var e=!0,r=!1,i=void 0;try{for(var n,a=["item","category","menu","site"][Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var o=n.value;if(t.includes(o))return!0}}catch(t){r=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw i}}},updateParams:function(){this.params.id=Number(this.$route.query.id)||"",this.params.pid=Number(this.$route.query.pid)||1,this.$set(this.toolbar,"type",this.params.id?"edit":"add")},initData:function(){this.updateParams(),this.params.id&&this.handleGetData()}}}},jgiN:function(t,e,r){var i=r("VU/8")(r("A37C"),r("43l3"),!1,null,null,null);t.exports=i.exports}});